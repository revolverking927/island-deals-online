<!DOCTYPE html>
<html>
<head>
    <title>Manufacturer Dashboard</title>
    <link rel="stylesheet" href="/styles/styles.css">
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        input, select, button { width: 100%; padding: 10px; margin-bottom: 15px; }
        button { background: #0275d8; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
        h2 { margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Manufacturer Dashboard</h1>
        <h2>Add New Discount</h2>
        <form id="discountForm">
            <label>Parish</label>
            <select name="parish" required>
                <option value="" disabled selected>Select Parish</option>
                <option value="Kingston">Kingston</option>
                <option value="St. Andrew">St. Andrew</option>
                <option value="St. Catherine">St. Catherine</option>
                <!-- Add more parishes -->
            </select>

            <label>Title</label>
            <input type="text" name="title" placeholder="Enter discount title" required>

            <label>Reason</label>
            <input type="text" name="reason" placeholder="Enter reason for discount" required>

            <label>Valid Until</label>
            <input type="date" name="valid_until" required>

            <button type="submit">Add Discount</button>
        </form>

        <div id="message"></div>
    </div>

<script>
    const discountForm = document.getElementById("discountForm");
    const messageDiv = document.getElementById("message");

    discountForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const formData = new FormData(discountForm);
        const data = Object.fromEntries(formData.entries());

        try {
            const res = await fetch("/api/discounts", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });

            const result = await res.json();

            if (res.ok) {
                messageDiv.innerText = "Discount added successfully!";
                discountForm.reset();
            } else {
                messageDiv.innerText = "Error: " + result.error;
            }
        } catch (err) {
            console.error(err);
            messageDiv.innerText = "Server error.";
        }
    });
</script>
</body>
</html>
